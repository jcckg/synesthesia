#pragma once

#include <array>
#include <vector>
#include <cmath>
#include "constants.h"

#ifdef USE_NEON_OPTIMISATIONS
#include "neon/colour_mapper_neon.h"
#endif

#if defined(__SSE__) || defined(__SSE2__) || defined(_M_X64) || defined(_M_AMD64)
#include "sse/colour_mapper_sse.h"
#endif

class ColourMapper {
public:
	struct ColourResult {
		float r;
		float g;
		float b;
		float dominantWavelength;
		float dominantFrequency;
		float colourIntensity;
		float L;
		float a;
		float b_comp;
		float spectralCentroid;
		float spectralFlatness;
		float spectralSpread;
		float spectralRolloff;
		float spectralCrestFactor;
	};

	struct SpectralCharacteristics {
		float flatness;
		float centroid;
		float spread;
		float normalisedSpread = 0.0f;
	};

	static constexpr float MIN_WAVELENGTH = synesthesia::constants::MIN_WAVELENGTH_NM;
	static constexpr float MAX_WAVELENGTH = synesthesia::constants::MAX_WAVELENGTH_NM;
	static constexpr float MIN_FREQ = synesthesia::constants::MIN_AUDIO_FREQ;
	static constexpr float MAX_FREQ = synesthesia::constants::MAX_AUDIO_FREQ;
	static constexpr size_t CIE_TABLE_SIZE = 441;

	static constexpr float SUB_AUDIO_BRIGHTNESS_BOOST = 3.0f;
	static constexpr float SPREAD_NORMALISATION = 5000.0f;
	static constexpr float EPSILON_SMALL = 1e-6f;
	static constexpr float EPSILON_TINY = 1e-10f;
	static constexpr float SRGB_GAMMA_ENCODE_THRESHOLD = 0.0031308f;
	static constexpr float SRGB_GAMMA_DECODE_THRESHOLD = 0.04045f;

	using ColourSpace = ::ColourSpace;

	static ColourResult spectrumToColour(const std::vector<float>& magnitudes,
										 const std::vector<float>& phases,
										 float sampleRate = 44100.0f, float gamma = 1.0f,
										 ColourSpace colourSpace = ColourSpace::Rec2020,
										 bool applyGamutMapping = true);

	static float logFrequencyToWavelength(float freq);
	static void wavelengthToRGBCIE(float wavelength, float& r, float& g, float& b,
								   ColourSpace colourSpace = ColourSpace::Rec2020,
								   bool applyGamutMapping = true);
	static float wavelengthToLogFrequency(float wavelength);
	static float XYZtoDominantWavelength(float X, float Y, float Z);
	static void RGBtoLab(float r, float g, float b, float& L, float& a, float& b_comp,
						 ColourSpace colourSpace = ColourSpace::Rec2020);
	static void LabtoRGB(float L, float a, float b_comp, float& r, float& g, float& b,
						 ColourSpace colourSpace = ColourSpace::Rec2020);
	static void XYZtoLab(float X, float Y, float Z, float& L, float& a, float& b);
	static void LabtoXYZ(float L, float a, float b, float& X, float& Y, float& Z);

	static void RGBtoOklab(float r, float g, float b, float& L, float& a, float& b_comp,
						   ColourSpace colourSpace = ColourSpace::Rec2020);
	static void OklabtoRGB(float L, float a, float b_comp, float& r, float& g, float& b,
						   ColourSpace colourSpace = ColourSpace::Rec2020);

	static void XYZtoRGB(float X, float Y, float Z, float& r, float& g, float& b,
						 ColourSpace colourSpace, bool applyGamma = true,
						 bool applyGamutMapping = true);
	static void RGBtoXYZ(float r, float g, float b, float& X, float& Y, float& Z,
						 ColourSpace colourSpace);
	static void gamutMapRGB(float& r, float& g, float& b);

	static SpectralCharacteristics calculateSpectralCharacteristics(
		const std::vector<float>& spectrum, float sampleRate);

	static void interpolateCIE(float wavelength, float& X, float& Y, float& Z);

private:
	static bool isValidFrequencyMagnitudePair(float frequency, float magnitude) {
		return std::isfinite(frequency) && std::isfinite(magnitude) &&
		       frequency > 0.0f && magnitude >= 0.0f;
	}

	static constexpr bool isValidFrequency(float frequency) {
		return frequency >= MIN_FREQ && frequency <= MAX_FREQ;
	}

	struct RayIntersectionResult {
		bool found;
		float wavelength;
		float parameterT;
	};

	static RayIntersectionResult findSpectrumIntersection(
		float rayDX, float rayDY, float whiteX, float whiteY);

	static float findClosestSpectralMatch(
		float rayDX, float rayDY, float whiteX, float whiteY, float rayLength);

	// CIE Standard Illuminant D65 reference white point for CIE 2006 2° observer
	static constexpr float REF_X = synesthesia::constants::CIE_D65_REF_X;
	static constexpr float REF_Y = synesthesia::constants::CIE_D65_REF_Y;
	static constexpr float REF_Z = synesthesia::constants::CIE_D65_REF_Z;

	// CIE 2006 2-degree standard observer dataset
	// Wavelength range: 390-830 nm with 1 nm steps
	// Format: {wavelength (nm), x̄, ȳ, z̄}
	// Reference: http://www.cvrl.org/
	static constexpr std::array<std::array<float, 4>, CIE_TABLE_SIZE> CIE_2006 = {
		{{390, 3.769647E-03f, 4.146161E-04f, 1.847260E-02f},
		{391, 4.532416E-03f, 5.028333E-04f, 2.221101E-02f},
		{392, 5.446553E-03f, 6.084991E-04f, 2.669819E-02f},
		{393, 6.538868E-03f, 7.344436E-04f, 3.206937E-02f},
		{394, 7.839699E-03f, 8.837389E-04f, 3.847832E-02f},
		{395, 9.382967E-03f, 1.059646E-03f, 4.609784E-02f},
		{396, 1.120608E-02f, 1.265532E-03f, 5.511953E-02f},
		{397, 1.334965E-02f, 1.504753E-03f, 6.575257E-02f},
		{398, 1.585690E-02f, 1.780493E-03f, 7.822113E-02f},
		{399, 1.877286E-02f, 2.095572E-03f, 9.276013E-02f},
		{400, 2.214302E-02f, 2.452194E-03f, 1.096090E-01f},
		{401, 2.601285E-02f, 2.852216E-03f, 1.290077E-01f},
		{402, 3.043036E-02f, 3.299115E-03f, 1.512047E-01f},
		{403, 3.544325E-02f, 3.797466E-03f, 1.764441E-01f},
		{404, 4.109640E-02f, 4.352768E-03f, 2.049517E-01f},
		{405, 4.742986E-02f, 4.971717E-03f, 2.369246E-01f},
		{406, 5.447394E-02f, 5.661014E-03f, 2.725123E-01f},
		{407, 6.223612E-02f, 6.421615E-03f, 3.117820E-01f},
		{408, 7.070048E-02f, 7.250312E-03f, 3.547064E-01f},
		{409, 7.982513E-02f, 8.140173E-03f, 4.011473E-01f},
		{410, 8.953803E-02f, 9.079860E-03f, 4.508369E-01f},
		{411, 9.974848E-02f, 1.005608E-02f, 5.034164E-01f},
		{412, 1.104019E-01f, 1.106456E-02f, 5.586361E-01f},
		{413, 1.214566E-01f, 1.210522E-02f, 6.162734E-01f},
		{414, 1.328741E-01f, 1.318014E-02f, 6.760982E-01f},
		{415, 1.446214E-01f, 1.429377E-02f, 7.378822E-01f},
		{416, 1.566468E-01f, 1.545004E-02f, 8.013019E-01f},
		{417, 1.687901E-01f, 1.664093E-02f, 8.655573E-01f},
		{418, 1.808328E-01f, 1.785302E-02f, 9.295791E-01f},
		{419, 1.925216E-01f, 1.907018E-02f, 9.921293E-01f},
		{420, 2.035729E-01f, 2.027369E-02f, 1.051821E+00f},
		{421, 2.137531E-01f, 2.144805E-02f, 1.107509E+00f},
		{422, 2.231348E-01f, 2.260041E-02f, 1.159527E+00f},
		{423, 2.319245E-01f, 2.374789E-02f, 1.208869E+00f},
		{424, 2.403892E-01f, 2.491247E-02f, 1.256834E+00f},
		{425, 2.488523E-01f, 2.612106E-02f, 1.305008E+00f},
		{426, 2.575896E-01f, 2.739923E-02f, 1.354758E+00f},
		{427, 2.664991E-01f, 2.874993E-02f, 1.405594E+00f},
		{428, 2.753532E-01f, 3.016909E-02f, 1.456414E+00f},
		{429, 2.838921E-01f, 3.165145E-02f, 1.505960E+00f},
		{430, 2.918246E-01f, 3.319038E-02f, 1.552826E+00f},
		{431, 2.989200E-01f, 3.477912E-02f, 1.595902E+00f},
		{432, 3.052993E-01f, 3.641495E-02f, 1.635768E+00f},
		{433, 3.112031E-01f, 3.809569E-02f, 1.673573E+00f},
		{434, 3.169047E-01f, 3.981843E-02f, 1.710604E+00f},
		{435, 3.227087E-01f, 4.157940E-02f, 1.748280E+00f},
		{436, 3.288194E-01f, 4.337098E-02f, 1.787504E+00f},
		{437, 3.349242E-01f, 4.517180E-02f, 1.826609E+00f},
		{438, 3.405452E-01f, 4.695420E-02f, 1.863108E+00f},
		{439, 3.451688E-01f, 4.868718E-02f, 1.894332E+00f},
		{440, 3.482554E-01f, 5.033657E-02f, 1.917479E+00f},
		{441, 3.494153E-01f, 5.187611E-02f, 1.930529E+00f},
		{442, 3.489075E-01f, 5.332218E-02f, 1.934819E+00f},
		{443, 3.471746E-01f, 5.470603E-02f, 1.932650E+00f},
		{444, 3.446705E-01f, 5.606335E-02f, 1.926395E+00f},
		{445, 3.418483E-01f, 5.743393E-02f, 1.918437E+00f},
		{446, 3.390240E-01f, 5.885107E-02f, 1.910430E+00f},
		{447, 3.359926E-01f, 6.030809E-02f, 1.901224E+00f},
		{448, 3.324276E-01f, 6.178644E-02f, 1.889000E+00f},
		{449, 3.280157E-01f, 6.326570E-02f, 1.871996E+00f},
		{450, 3.224637E-01f, 6.472352E-02f, 1.848545E+00f},
		{451, 3.156225E-01f, 6.614749E-02f, 1.817792E+00f},
		{452, 3.078201E-01f, 6.757256E-02f, 1.781627E+00f},
		{453, 2.994771E-01f, 6.904928E-02f, 1.742514E+00f},
		{454, 2.909776E-01f, 7.063280E-02f, 1.702749E+00f},
		{455, 2.826646E-01f, 7.238339E-02f, 1.664439E+00f},
		{456, 2.747962E-01f, 7.435960E-02f, 1.629207E+00f},
		{457, 2.674312E-01f, 7.659383E-02f, 1.597360E+00f},
		{458, 2.605847E-01f, 7.911436E-02f, 1.568896E+00f},
		{459, 2.542749E-01f, 8.195345E-02f, 1.543823E+00f},
		{460, 2.485254E-01f, 8.514816E-02f, 1.522157E+00f},
		{461, 2.433039E-01f, 8.872657E-02f, 1.503611E+00f},
		{462, 2.383414E-01f, 9.266008E-02f, 1.486673E+00f},
		{463, 2.333253E-01f, 9.689723E-02f, 1.469595E+00f},
		{464, 2.279619E-01f, 1.013746E-01f, 1.450709E+00f},
		{465, 2.219781E-01f, 1.060145E-01f, 1.428440E+00f},
		{466, 2.151735E-01f, 1.107377E-01f, 1.401587E+00f},
		{467, 2.075619E-01f, 1.155111E-01f, 1.370094E+00f},
		{468, 1.992183E-01f, 1.203122E-01f, 1.334220E+00f},
		{469, 1.902290E-01f, 1.251161E-01f, 1.294275E+00f},
		{470, 1.806905E-01f, 1.298957E-01f, 1.250610E+00f},
		{471, 1.707154E-01f, 1.346299E-01f, 1.203696E+00f},
		{472, 1.604471E-01f, 1.393309E-01f, 1.154316E+00f},
		{473, 1.500244E-01f, 1.440235E-01f, 1.103284E+00f},
		{474, 1.395705E-01f, 1.487372E-01f, 1.051347E+00f},
		{475, 1.291920E-01f, 1.535066E-01f, 9.991789E-01f},
		{476, 1.189859E-01f, 1.583644E-01f, 9.473958E-01f},
		{477, 1.090615E-01f, 1.633199E-01f, 8.966222E-01f},
		{478, 9.951424E-02f, 1.683761E-01f, 8.473981E-01f},
		{479, 9.041850E-02f, 1.735365E-01f, 8.001576E-01f},
		{480, 8.182895E-02f, 1.788048E-01f, 7.552379E-01f},
		{481, 7.376817E-02f, 1.841819E-01f, 7.127879E-01f},
		{482, 6.619477E-02f, 1.896559E-01f, 6.725198E-01f},
		{483, 5.906380E-02f, 1.952101E-01f, 6.340976E-01f},
		{484, 5.234242E-02f, 2.008259E-01f, 5.972433E-01f},
		{485, 4.600865E-02f, 2.064828E-01f, 5.617313E-01f},
		{486, 4.006154E-02f, 2.121826E-01f, 5.274921E-01f},
		{487, 3.454373E-02f, 2.180279E-01f, 4.948809E-01f},
		{488, 2.949091E-02f, 2.241586E-01f, 4.642586E-01f},
		{489, 2.492140E-02f, 2.307302E-01f, 4.358841E-01f},
		{490, 2.083981E-02f, 2.379160E-01f, 4.099313E-01f},
		{491, 1.723591E-02f, 2.458706E-01f, 3.864261E-01f},
		{492, 1.407924E-02f, 2.546023E-01f, 3.650566E-01f},
		{493, 1.134516E-02f, 2.640760E-01f, 3.454812E-01f},
		{494, 9.019658E-03f, 2.742490E-01f, 3.274095E-01f},
		{495, 7.097731E-03f, 2.850680E-01f, 3.105939E-01f},
		{496, 5.571145E-03f, 2.964837E-01f, 2.948102E-01f},
		{497, 4.394566E-03f, 3.085010E-01f, 2.798194E-01f},
		{498, 3.516303E-03f, 3.211393E-01f, 2.654100E-01f},
		{499, 2.887638E-03f, 3.344175E-01f, 2.514084E-01f},
		{500, 2.461588E-03f, 3.483536E-01f, 2.376753E-01f},
		{501, 2.206348E-03f, 3.629601E-01f, 2.241211E-01f},
		{502, 2.149559E-03f, 3.782275E-01f, 2.107484E-01f},
		{503, 2.337091E-03f, 3.941359E-01f, 1.975839E-01f},
		{504, 2.818931E-03f, 4.106582E-01f, 1.846574E-01f},
		{505, 3.649178E-03f, 4.277595E-01f, 1.720018E-01f},
		{506, 4.891359E-03f, 4.453993E-01f, 1.596918E-01f},
		{507, 6.629364E-03f, 4.635396E-01f, 1.479415E-01f},
		{508, 8.942902E-03f, 4.821376E-01f, 1.369428E-01f},
		{509, 1.190224E-02f, 5.011430E-01f, 1.268279E-01f},
		{510, 1.556989E-02f, 5.204972E-01f, 1.176796E-01f},
		{511, 1.997668E-02f, 5.401387E-01f, 1.094970E-01f},
		{512, 2.504698E-02f, 5.600208E-01f, 1.020943E-01f},
		{513, 3.067530E-02f, 5.800972E-01f, 9.527993E-02f},
		{514, 3.674999E-02f, 6.003172E-01f, 8.890075E-02f},
		{515, 4.315171E-02f, 6.206256E-01f, 8.283548E-02f},
		{516, 4.978584E-02f, 6.409398E-01f, 7.700982E-02f},
		{517, 5.668554E-02f, 6.610772E-01f, 7.144001E-02f},
		{518, 6.391651E-02f, 6.808134E-01f, 6.615436E-02f},
		{519, 7.154352E-02f, 6.999044E-01f, 6.117199E-02f},
		{520, 7.962917E-02f, 7.180890E-01f, 5.650407E-02f},
		{521, 8.821473E-02f, 7.351593E-01f, 5.215121E-02f},
		{522, 9.726978E-02f, 7.511821E-01f, 4.809566E-02f},
		{523, 1.067504E-01f, 7.663143E-01f, 4.431720E-02f},
		{524, 1.166192E-01f, 7.807352E-01f, 4.079734E-02f},
		{525, 1.268468E-01f, 7.946448E-01f, 3.751912E-02f},
		{526, 1.374060E-01f, 8.082074E-01f, 3.446846E-02f},
		{527, 1.482471E-01f, 8.213817E-01f, 3.163764E-02f},
		{528, 1.593076E-01f, 8.340701E-01f, 2.901901E-02f},
		{529, 1.705181E-01f, 8.461711E-01f, 2.660364E-02f},
		{530, 1.818026E-01f, 8.575799E-01f, 2.438164E-02f},
		{531, 1.931090E-01f, 8.682408E-01f, 2.234097E-02f},
		{532, 2.045085E-01f, 8.783061E-01f, 2.046415E-02f},
		{533, 2.161166E-01f, 8.879907E-01f, 1.873456E-02f},
		{534, 2.280650E-01f, 8.975211E-01f, 1.713788E-02f},
		{535, 2.405015E-01f, 9.071347E-01f, 1.566174E-02f},
		{536, 2.535441E-01f, 9.169947E-01f, 1.429644E-02f},
		{537, 2.671300E-01f, 9.269295E-01f, 1.303702E-02f},
		{538, 2.811351E-01f, 9.366731E-01f, 1.187897E-02f},
		{539, 2.954164E-01f, 9.459482E-01f, 1.081725E-02f},
		{540, 3.098117E-01f, 9.544675E-01f, 9.846470E-03f},
		{541, 3.241678E-01f, 9.619834E-01f, 8.960687E-03f},
		{542, 3.384319E-01f, 9.684390E-01f, 8.152811E-03f},
		{543, 3.525786E-01f, 9.738289E-01f, 7.416025E-03f},
		{544, 3.665839E-01f, 9.781519E-01f, 6.744115E-03f},
		{545, 3.804244E-01f, 9.814106E-01f, 6.131421E-03f},
		{546, 3.940988E-01f, 9.836669E-01f, 5.572778E-03f},
		{547, 4.076972E-01f, 9.852081E-01f, 5.063463E-03f},
		{548, 4.213484E-01f, 9.863813E-01f, 4.599169E-03f},
		{549, 4.352003E-01f, 9.875357E-01f, 4.175971E-03f},
		{550, 4.494206E-01f, 9.890228E-01f, 3.790291E-03f},
		{551, 4.641616E-01f, 9.910811E-01f, 3.438952E-03f},
		{552, 4.794395E-01f, 9.934913E-01f, 3.119341E-03f},
		{553, 4.952180E-01f, 9.959172E-01f, 2.829038E-03f},
		{554, 5.114395E-01f, 9.980205E-01f, 2.565722E-03f},
		{555, 5.280233E-01f, 9.994608E-01f, 2.327186E-03f},
		{556, 5.448696E-01f, 9.999930E-01f, 2.111280E-03f},
		{557, 5.618898E-01f, 9.997557E-01f, 1.915766E-03f},
		{558, 5.790137E-01f, 9.989839E-01f, 1.738589E-03f},
		{559, 5.961882E-01f, 9.979123E-01f, 1.577920E-03f},
		{560, 6.133784E-01f, 9.967737E-01f, 1.432128E-03f},
		{561, 6.305897E-01f, 9.957356E-01f, 1.299781E-03f},
		{562, 6.479223E-01f, 9.947115E-01f, 1.179667E-03f},
		{563, 6.654866E-01f, 9.935534E-01f, 1.070694E-03f},
		{564, 6.833782E-01f, 9.921156E-01f, 9.718623E-04f},
		{565, 7.016774E-01f, 9.902549E-01f, 8.822531E-04f},
		{566, 7.204110E-01f, 9.878596E-01f, 8.010231E-04f},
		{567, 7.394495E-01f, 9.849324E-01f, 7.273884E-04f},
		{568, 7.586285E-01f, 9.815036E-01f, 6.606347E-04f},
		{569, 7.777885E-01f, 9.776035E-01f, 6.001146E-04f},
		{570, 7.967750E-01f, 9.732611E-01f, 5.452416E-04f},
		{571, 8.154530E-01f, 9.684764E-01f, 4.954847E-04f},
		{572, 8.337389E-01f, 9.631369E-01f, 4.503642E-04f},
		{573, 8.515493E-01f, 9.571062E-01f, 4.094455E-04f},
		{574, 8.687862E-01f, 9.502540E-01f, 3.723345E-04f},
		{575, 8.853376E-01f, 9.424569E-01f, 3.386739E-04f},
		{576, 9.011588E-01f, 9.336897E-01f, 3.081396E-04f},
		{577, 9.165278E-01f, 9.242893E-01f, 2.804370E-04f},
		{578, 9.318245E-01f, 9.146707E-01f, 2.552996E-04f},
		{579, 9.474524E-01f, 9.052333E-01f, 2.324859E-04f},
		{580, 9.638388E-01f, 8.963613E-01f, 2.117772E-04f},
		{581, 9.812596E-01f, 8.883069E-01f, 1.929758E-04f},
		{582, 9.992953E-01f, 8.808462E-01f, 1.759024E-04f},
		{583, 1.017343E+00f, 8.736445E-01f, 1.603947E-04f},
		{584, 1.034790E+00f, 8.663755E-01f, 1.463059E-04f},
		{585, 1.051011E+00f, 8.587203E-01f, 1.335031E-04f},
		{586, 1.065522E+00f, 8.504295E-01f, 1.218660E-04f},
		{587, 1.078421E+00f, 8.415047E-01f, 1.112857E-04f},
		{588, 1.089944E+00f, 8.320109E-01f, 1.016634E-04f},
		{589, 1.100320E+00f, 8.220154E-01f, 9.291003E-05f},
		{590, 1.109767E+00f, 8.115868E-01f, 8.494468E-05f},
		{591, 1.118438E+00f, 8.007874E-01f, 7.769425E-05f},
		{592, 1.126266E+00f, 7.896515E-01f, 7.109247E-05f},
		{593, 1.133138E+00f, 7.782053E-01f, 6.507936E-05f},
		{594, 1.138952E+00f, 7.664733E-01f, 5.960061E-05f},
		{595, 1.143620E+00f, 7.544785E-01f, 5.460706E-05f},
		{596, 1.147095E+00f, 7.422473E-01f, 5.005417E-05f},
		{597, 1.149464E+00f, 7.298229E-01f, 4.590157E-05f},
		{598, 1.150838E+00f, 7.172525E-01f, 4.211268E-05f},
		{599, 1.151326E+00f, 7.045818E-01f, 3.865437E-05f},
		{600, 1.151033E+00f, 6.918553E-01f, 3.549661E-05f},
		{601, 1.150002E+00f, 6.791009E-01f, 3.261220E-05f},
		{602, 1.148061E+00f, 6.662846E-01f, 2.997643E-05f},
		{603, 1.144998E+00f, 6.533595E-01f, 2.756693E-05f},
		{604, 1.140622E+00f, 6.402807E-01f, 2.536339E-05f},
		{605, 1.134757E+00f, 6.270066E-01f, 2.334738E-05f},
		{606, 1.127298E+00f, 6.135148E-01f, 2.150221E-05f},
		{607, 1.118342E+00f, 5.998494E-01f, 1.981268E-05f},
		{608, 1.108033E+00f, 5.860682E-01f, 1.826500E-05f},
		{609, 1.096515E+00f, 5.722261E-01f, 1.684667E-05f},
		{610, 1.083928E+00f, 5.583746E-01f, 1.554631E-05f},
		{611, 1.070387E+00f, 5.445535E-01f, 1.435360E-05f},
		{612, 1.055934E+00f, 5.307673E-01f, 1.325915E-05f},
		{613, 1.040592E+00f, 5.170130E-01f, 1.225443E-05f},
		{614, 1.024385E+00f, 5.032889E-01f, 1.133169E-05f},
		{615, 1.007344E+00f, 4.895950E-01f, 1.048387E-05f},
		{616, 9.895268E-01f, 4.759442E-01f, 0.000000E+00f},
		{617, 9.711213E-01f, 4.623958E-01f, 0.000000E+00f},
		{618, 9.523257E-01f, 4.490154E-01f, 0.000000E+00f},
		{619, 9.333248E-01f, 4.358622E-01f, 0.000000E+00f},
		{620, 9.142877E-01f, 4.229897E-01f, 0.000000E+00f},
		{621, 8.952798E-01f, 4.104152E-01f, 0.000000E+00f},
		{622, 8.760157E-01f, 3.980356E-01f, 0.000000E+00f},
		{623, 8.561607E-01f, 3.857300E-01f, 0.000000E+00f},
		{624, 8.354235E-01f, 3.733907E-01f, 0.000000E+00f},
		{625, 8.135565E-01f, 3.609245E-01f, 0.000000E+00f},
		{626, 7.904565E-01f, 3.482860E-01f, 0.000000E+00f},
		{627, 7.664364E-01f, 3.355702E-01f, 0.000000E+00f},
		{628, 7.418777E-01f, 3.228963E-01f, 0.000000E+00f},
		{629, 7.171219E-01f, 3.103704E-01f, 0.000000E+00f},
		{630, 6.924717E-01f, 2.980865E-01f, 0.000000E+00f},
		{631, 6.681600E-01f, 2.861160E-01f, 0.000000E+00f},
		{632, 6.442697E-01f, 2.744822E-01f, 0.000000E+00f},
		{633, 6.208450E-01f, 2.631953E-01f, 0.000000E+00f},
		{634, 5.979243E-01f, 2.522628E-01f, 0.000000E+00f},
		{635, 5.755410E-01f, 2.416902E-01f, 0.000000E+00f},
		{636, 5.537296E-01f, 2.314809E-01f, 0.000000E+00f},
		{637, 5.325412E-01f, 2.216378E-01f, 0.000000E+00f},
		{638, 5.120218E-01f, 2.121622E-01f, 0.000000E+00f},
		{639, 4.922070E-01f, 2.030542E-01f, 0.000000E+00f},
		{640, 4.731224E-01f, 1.943124E-01f, 0.000000E+00f},
		{641, 4.547417E-01f, 1.859227E-01f, 0.000000E+00f},
		{642, 4.368719E-01f, 1.778274E-01f, 0.000000E+00f},
		{643, 4.193121E-01f, 1.699654E-01f, 0.000000E+00f},
		{644, 4.018980E-01f, 1.622841E-01f, 0.000000E+00f},
		{645, 3.844986E-01f, 1.547397E-01f, 0.000000E+00f},
		{646, 3.670592E-01f, 1.473081E-01f, 0.000000E+00f},
		{647, 3.497167E-01f, 1.400169E-01f, 0.000000E+00f},
		{648, 3.326305E-01f, 1.329013E-01f, 0.000000E+00f},
		{649, 3.159341E-01f, 1.259913E-01f, 0.000000E+00f},
		{650, 2.997374E-01f, 1.193120E-01f, 0.000000E+00f},
		{651, 2.841189E-01f, 1.128820E-01f, 0.000000E+00f},
		{652, 2.691053E-01f, 1.067113E-01f, 0.000000E+00f},
		{653, 2.547077E-01f, 1.008052E-01f, 0.000000E+00f},
		{654, 2.409319E-01f, 9.516653E-02f, 0.000000E+00f},
		{655, 2.277792E-01f, 8.979594E-02f, 0.000000E+00f},
		{656, 2.152431E-01f, 8.469044E-02f, 0.000000E+00f},
		{657, 2.033010E-01f, 7.984009E-02f, 0.000000E+00f},
		{658, 1.919276E-01f, 7.523372E-02f, 0.000000E+00f},
		{659, 1.810987E-01f, 7.086061E-02f, 0.000000E+00f},
		{660, 1.707914E-01f, 6.671045E-02f, 0.000000E+00f},
		{661, 1.609842E-01f, 6.277360E-02f, 0.000000E+00f},
		{662, 1.516577E-01f, 5.904179E-02f, 0.000000E+00f},
		{663, 1.427936E-01f, 5.550703E-02f, 0.000000E+00f},
		{664, 1.343737E-01f, 5.216139E-02f, 0.000000E+00f},
		{665, 1.263808E-01f, 4.899699E-02f, 0.000000E+00f},
		{666, 1.187979E-01f, 4.600578E-02f, 0.000000E+00f},
		{667, 1.116088E-01f, 4.317885E-02f, 0.000000E+00f},
		{668, 1.047975E-01f, 4.050755E-02f, 0.000000E+00f},
		{669, 9.834835E-02f, 3.798376E-02f, 0.000000E+00f},
		{670, 9.224597E-02f, 3.559982E-02f, 0.000000E+00f},
		{671, 8.647506E-02f, 3.334856E-02f, 0.000000E+00f},
		{672, 8.101986E-02f, 3.122332E-02f, 0.000000E+00f},
		{673, 7.586514E-02f, 2.921780E-02f, 0.000000E+00f},
		{674, 7.099633E-02f, 2.732601E-02f, 0.000000E+00f},
		{675, 6.639960E-02f, 2.554223E-02f, 0.000000E+00f},
		{676, 6.206225E-02f, 2.386121E-02f, 0.000000E+00f},
		{677, 5.797409E-02f, 2.227859E-02f, 0.000000E+00f},
		{678, 5.412533E-02f, 2.079020E-02f, 0.000000E+00f},
		{679, 5.050600E-02f, 1.939185E-02f, 0.000000E+00f},
		{680, 4.710606E-02f, 1.807939E-02f, 0.000000E+00f},
		{681, 4.391411E-02f, 1.684817E-02f, 0.000000E+00f},
		{682, 4.091411E-02f, 1.569188E-02f, 0.000000E+00f},
		{683, 3.809067E-02f, 1.460446E-02f, 0.000000E+00f},
		{684, 3.543034E-02f, 1.358062E-02f, 0.000000E+00f},
		{685, 3.292138E-02f, 1.261573E-02f, 0.000000E+00f},
		{686, 3.055672E-02f, 1.170696E-02f, 0.000000E+00f},
		{687, 2.834146E-02f, 1.085608E-02f, 0.000000E+00f},
		{688, 2.628033E-02f, 1.006476E-02f, 0.000000E+00f},
		{689, 2.437465E-02f, 9.333376E-03f, 0.000000E+00f},
		{690, 2.262306E-02f, 8.661284E-03f, 0.000000E+00f},
		{691, 2.101935E-02f, 8.046048E-03f, 0.000000E+00f},
		{692, 1.954647E-02f, 7.481130E-03f, 0.000000E+00f},
		{693, 1.818727E-02f, 6.959987E-03f, 0.000000E+00f},
		{694, 1.692727E-02f, 6.477070E-03f, 0.000000E+00f},
		{695, 1.575417E-02f, 6.027677E-03f, 0.000000E+00f},
		{696, 1.465854E-02f, 5.608169E-03f, 0.000000E+00f},
		{697, 1.363571E-02f, 5.216691E-03f, 0.000000E+00f},
		{698, 1.268205E-02f, 4.851785E-03f, 0.000000E+00f},
		{699, 1.179394E-02f, 4.512008E-03f, 0.000000E+00f},
		{700, 1.096778E-02f, 4.195941E-03f, 0.000000E+00f},
		{701, 1.019964E-02f, 3.902057E-03f, 0.000000E+00f},
		{702, 9.484317E-03f, 3.628371E-03f, 0.000000E+00f},
		{703, 8.816851E-03f, 3.373005E-03f, 0.000000E+00f},
		{704, 8.192921E-03f, 3.134315E-03f, 0.000000E+00f},
		{705, 7.608750E-03f, 2.910864E-03f, 0.000000E+00f},
		{706, 7.061391E-03f, 2.701528E-03f, 0.000000E+00f},
		{707, 6.549509E-03f, 2.505796E-03f, 0.000000E+00f},
		{708, 6.071970E-03f, 2.323231E-03f, 0.000000E+00f},
		{709, 5.627476E-03f, 2.153333E-03f, 0.000000E+00f},
		{710, 5.214608E-03f, 1.995557E-03f, 0.000000E+00f},
		{711, 4.831848E-03f, 1.849316E-03f, 0.000000E+00f},
		{712, 4.477579E-03f, 1.713976E-03f, 0.000000E+00f},
		{713, 4.150166E-03f, 1.588899E-03f, 0.000000E+00f},
		{714, 3.847988E-03f, 1.473453E-03f, 0.000000E+00f},
		{715, 3.569452E-03f, 1.367022E-03f, 0.000000E+00f},
		{716, 3.312857E-03f, 1.268954E-03f, 0.000000E+00f},
		{717, 3.076022E-03f, 1.178421E-03f, 0.000000E+00f},
		{718, 2.856894E-03f, 1.094644E-03f, 0.000000E+00f},
		{719, 2.653681E-03f, 1.016943E-03f, 0.000000E+00f},
		{720, 2.464821E-03f, 9.447269E-04f, 0.000000E+00f},
		{721, 2.289060E-03f, 8.775171E-04f, 0.000000E+00f},
		{722, 2.125694E-03f, 8.150438E-04f, 0.000000E+00f},
		{723, 1.974121E-03f, 7.570755E-04f, 0.000000E+00f},
		{724, 1.833723E-03f, 7.033755E-04f, 0.000000E+00f},
		{725, 1.703876E-03f, 6.537050E-04f, 0.000000E+00f},
		{726, 1.583904E-03f, 6.078048E-04f, 0.000000E+00f},
		{727, 1.472939E-03f, 5.653435E-04f, 0.000000E+00f},
		{728, 1.370151E-03f, 5.260046E-04f, 0.000000E+00f},
		{729, 1.274803E-03f, 4.895061E-04f, 0.000000E+00f},
		{730, 1.186238E-03f, 4.555970E-04f, 0.000000E+00f},
		{731, 1.103871E-03f, 4.240548E-04f, 0.000000E+00f},
		{732, 1.027194E-03f, 3.946860E-04f, 0.000000E+00f},
		{733, 9.557493E-04f, 3.673178E-04f, 0.000000E+00f},
		{734, 8.891262E-04f, 3.417941E-04f, 0.000000E+00f},
		{735, 8.269535E-04f, 3.179738E-04f, 0.000000E+00f},
		{736, 7.689351E-04f, 2.957441E-04f, 0.000000E+00f},
		{737, 7.149425E-04f, 2.750558E-04f, 0.000000E+00f},
		{738, 6.648590E-04f, 2.558640E-04f, 0.000000E+00f},
		{739, 6.185421E-04f, 2.381142E-04f, 0.000000E+00f},
		{740, 5.758303E-04f, 2.217445E-04f, 0.000000E+00f},
		{741, 5.365046E-04f, 2.066711E-04f, 0.000000E+00f},
		{742, 5.001842E-04f, 1.927474E-04f, 0.000000E+00f},
		{743, 4.665005E-04f, 1.798315E-04f, 0.000000E+00f},
		{744, 4.351386E-04f, 1.678023E-04f, 0.000000E+00f},
		{745, 4.058303E-04f, 1.565566E-04f, 0.000000E+00f},
		{746, 3.783733E-04f, 1.460168E-04f, 0.000000E+00f},
		{747, 3.526892E-04f, 1.361535E-04f, 0.000000E+00f},
		{748, 3.287199E-04f, 1.269451E-04f, 0.000000E+00f},
		{749, 3.063998E-04f, 1.183671E-04f, 0.000000E+00f},
		{750, 2.856577E-04f, 1.103928E-04f, 0.000000E+00f},
		{751, 2.664108E-04f, 1.029908E-04f, 0.000000E+00f},
		{752, 2.485462E-04f, 9.611836E-05f, 0.000000E+00f},
		{753, 2.319529E-04f, 8.973323E-05f, 0.000000E+00f},
		{754, 2.165300E-04f, 8.379694E-05f, 0.000000E+00f},
		{755, 2.021853E-04f, 7.827442E-05f, 0.000000E+00f},
		{756, 1.888338E-04f, 7.313312E-05f, 0.000000E+00f},
		{757, 1.763935E-04f, 6.834142E-05f, 0.000000E+00f},
		{758, 1.647895E-04f, 6.387035E-05f, 0.000000E+00f},
		{759, 1.539542E-04f, 5.969389E-05f, 0.000000E+00f},
		{760, 1.438270E-04f, 5.578862E-05f, 0.000000E+00f},
		{761, 1.343572E-04f, 5.213509E-05f, 0.000000E+00f},
		{762, 1.255141E-04f, 4.872179E-05f, 0.000000E+00f},
		{763, 1.172706E-04f, 4.553845E-05f, 0.000000E+00f},
		{764, 1.095983E-04f, 4.257443E-05f, 0.000000E+00f},
		{765, 1.024685E-04f, 3.981884E-05f, 0.000000E+00f},
		{766, 9.584715E-05f, 3.725877E-05f, 0.000000E+00f},
		{767, 8.968316E-05f, 3.487467E-05f, 0.000000E+00f},
		{768, 8.392734E-05f, 3.264765E-05f, 0.000000E+00f},
		{769, 7.853708E-05f, 3.056140E-05f, 0.000000E+00f},
		{770, 7.347551E-05f, 2.860175E-05f, 0.000000E+00f},
		{771, 6.871576E-05f, 2.675841E-05f, 0.000000E+00f},
		{772, 6.425257E-05f, 2.502943E-05f, 0.000000E+00f},
		{773, 6.008292E-05f, 2.341373E-05f, 0.000000E+00f},
		{774, 5.620098E-05f, 2.190914E-05f, 0.000000E+00f},
		{775, 5.259870E-05f, 2.051259E-05f, 0.000000E+00f},
		{776, 4.926279E-05f, 1.921902E-05f, 0.000000E+00f},
		{777, 4.616623E-05f, 1.801796E-05f, 0.000000E+00f},
		{778, 4.328212E-05f, 1.689899E-05f, 0.000000E+00f},
		{779, 4.058715E-05f, 1.585309E-05f, 0.000000E+00f},
		{780, 3.806114E-05f, 1.487243E-05f, 0.000000E+00f},
		{781, 3.568818E-05f, 1.395085E-05f, 0.000000E+00f},
		{782, 3.346023E-05f, 1.308528E-05f, 0.000000E+00f},
		{783, 3.137090E-05f, 1.227327E-05f, 0.000000E+00f},
		{784, 2.941371E-05f, 1.151233E-05f, 0.000000E+00f},
		{785, 2.758222E-05f, 1.080001E-05f, 0.000000E+00f},
		{786, 2.586951E-05f, 1.013364E-05f, 0.000000E+00f},
		{787, 2.426701E-05f, 9.509919E-06f, 0.000000E+00f},
		{788, 2.276639E-05f, 8.925630E-06f, 0.000000E+00f},
		{789, 2.136009E-05f, 8.377852E-06f, 0.000000E+00f},
		{790, 2.004122E-05f, 7.863920E-06f, 0.000000E+00f},
		{791, 1.880380E-05f, 7.381539E-06f, 0.000000E+00f},
		{792, 1.764358E-05f, 6.929096E-06f, 0.000000E+00f},
		{793, 1.655671E-05f, 6.505136E-06f, 0.000000E+00f},
		{794, 1.553939E-05f, 6.108221E-06f, 0.000000E+00f},
		{795, 1.458792E-05f, 5.736935E-06f, 0.000000E+00f},
		{796, 1.369853E-05f, 5.389831E-06f, 0.000000E+00f},
		{797, 1.286705E-05f, 5.065269E-06f, 0.000000E+00f},
		{798, 1.208947E-05f, 4.761667E-06f, 0.000000E+00f},
		{799, 1.136207E-05f, 4.477561E-06f, 0.000000E+00f},
		{800, 1.068141E-05f, 4.211597E-06f, 0.000000E+00f},
		{801, 1.004411E-05f, 3.962457E-06f, 0.000000E+00f},
		{802, 9.446399E-06f, 3.728674E-06f, 0.000000E+00f},
		{803, 8.884754E-06f, 3.508881E-06f, 0.000000E+00f},
		{804, 8.356050E-06f, 3.301868E-06f, 0.000000E+00f},
		{805, 7.857521E-06f, 3.106561E-06f, 0.000000E+00f},
		{806, 7.386996E-06f, 2.922119E-06f, 0.000000E+00f},
		{807, 6.943576E-06f, 2.748208E-06f, 0.000000E+00f},
		{808, 6.526548E-06f, 2.584560E-06f, 0.000000E+00f},
		{809, 6.135087E-06f, 2.430867E-06f, 0.000000E+00f},
		{810, 5.768284E-06f, 2.286786E-06f, 0.000000E+00f},
		{811, 5.425069E-06f, 2.151905E-06f, 0.000000E+00f},
		{812, 5.103974E-06f, 2.025656E-06f, 0.000000E+00f},
		{813, 4.803525E-06f, 1.907464E-06f, 0.000000E+00f},
		{814, 4.522350E-06f, 1.796794E-06f, 0.000000E+00f},
		{815, 4.259166E-06f, 1.693147E-06f, 0.000000E+00f},
		{816, 4.012715E-06f, 1.596032E-06f, 0.000000E+00f},
		{817, 3.781597E-06f, 1.504903E-06f, 0.000000E+00f},
		{818, 3.564496E-06f, 1.419245E-06f, 0.000000E+00f},
		{819, 3.360236E-06f, 1.338600E-06f, 0.000000E+00f},
		{820, 3.167765E-06f, 1.262556E-06f, 0.000000E+00f},
		{821, 2.986206E-06f, 1.190771E-06f, 0.000000E+00f},
		{822, 2.814999E-06f, 1.123031E-06f, 0.000000E+00f},
		{823, 2.653663E-06f, 1.059151E-06f, 0.000000E+00f},
		{824, 2.501725E-06f, 9.989507E-07f, 0.000000E+00f},
		{825, 2.358723E-06f, 9.422514E-07f, 0.000000E+00f},
		{826, 2.224206E-06f, 8.888804E-07f, 0.000000E+00f},
		{827, 2.097737E-06f, 8.386690E-07f, 0.000000E+00f},
		{828, 1.978894E-06f, 7.914539E-07f, 0.000000E+00f},
		{829, 1.867268E-06f, 7.470770E-07f, 0.000000E+00f},
		{830, 1.762465E-06f, 7.053860E-07f, 0.000000E+00f}}};
};
